/*! FlyThat - v0.1.0 - 2014-08-03
* https://github.com/lucasferreira/flythat
* Copyright (c) 2014 Lucas Ferreira; Licensed MIT */
!function(a,b,c,d){"use strict";function e(b,e){this._element=a(b),this._body=a(c.body),this._options=this._builOptions(e),a.support.transition||(a.support.transition=function(){var a=c.body||c.documentElement,b=a.style,e=b.transition!==d||b.WebkitTransition!==d||b.MozTransition!==d||b.MsTransition!==d||b.OTransition!==d;return e}()),a.support.transform||(a.support.transform=function(){var a=c.body||c.documentElement,b=a.style,e=b.transform!==d||b.WebkitTransform!==d||b.MozTransform!==d||b.MsTransform!==d||b.OTransform!==d;return e}()),a.each(this._options,a.proxy(function(a){null!=this._element.data(a.toLowerCase())&&(this._options[a]=this._element.data(a.toLowerCase()))},this)),this._init()}e.fn=e.prototype={_init:function(){if(this._options.backdrop?(this._element.parents(".flythat-backdrop").length||this._element.wrap("<div class='flythat-backdrop'></div>"),this._backdrop=this._element.parents(".flythat-backdrop").data("owner",this),this._backdrop.css({position:"absolute",top:0,bottom:0,left:0,right:0,zIndex:this._options.zIndex-1}),this._backdrop.css("position","fixed"),this._options.backdropClass&&this._backdrop.addClass(this._options.backdropClass),this._options.backdropColor&&this._backdrop.css("background-color",this._options.backdropColor),this._options.backdropColorRGBA&&this._backdrop.css("background-color",this._options.backdropColorRGBA),a.support.transform&&this._backdrop.css({"-webkit-transform-style":"preserve-3d","-moz-transform-style":"preserve-3d","-ms-transform-style":"preserve-3d","-o-transform-style":"preserve-3d","transform-style":"preserve-3d"})):(this._backdrop=!1,this._element.css({position:"absolute",zIndex:this._options.zIndex}),this._element.css("position","fixed"),a.support.transform&&this._element.css({"-webkit-transform-style":"preserve-3d","-moz-transform-style":"preserve-3d","-ms-transform-style":"preserve-3d","-o-transform-style":"preserve-3d","transform-style":"preserve-3d"})),this._handle().css({display:"none",visibility:"hidden",opacity:0}),this._addEventsListener(),this._options.autoOpen){this._timerToShow&&clearTimeout(this._timerToShow);var b="number"==typeof this._options.autoOpen?this._options.autoOpen:10;this._timerToShow=setTimeout(a.proxy(this.open,this),b)}this.show=this.open,this.hide=this.close},_builOptions:function(b){return a.extend({position:"center",autoOpen:!1,autoClose:!1,width:!1,height:!1,fadeIn:"normal",fadeOut:"normal",easing:"swing",closeClass:"close",closeEsc:!0,hideOnMobile:!1,backdrop:"close",backdropClass:!1,backdropColor:"#333333",backdropColorRGBA:" rgba(52, 76, 21, 0.75)",zIndex:8888},b)},_addEventsListener:function(){this._options.closeClass&&this._element.off("click.flythat").on("click.flythat","."+this._options.closeClass,a.proxy(this._clickClose,this)),this._backdrop&&"close"===this._options.backdrop&&this._backdrop.off("click.flythat").on("click.flythat",a.proxy(this._clickBackdrop,this)),this._options.closeEsc&&a(c).off("keyup.flythat").on("keyup.flythat",a.proxy(this._escClose,this))},_escClose:function(a){this._options.closeEsc&&27==a.keyCode&&this._handle().is(":visible")&&this.close()},_clickClose:function(a){return a.preventDefault(),this.close(),!1},_clickBackdrop:function(b){a(b.target).hasClass(this._options.backdropClass||"flythat-backdrop")&&(b.preventDefault(),this.close())},_handle:function(){return this._backdrop?this._backdrop:this._element},rebuild:function(a){this._options=this._builOptions(a||this._options),this._init()},placeThat:function(d){switch(this._element.css({position:"absolute",display:"block",top:"auto",bottom:"auto",left:"auto",right:"auto",zIndex:this._options.zIndex}),this._element.css("position","fixed"),d){case"left":this._element.css({top:0,left:0});break;case"right":this._element.css({top:0,right:0});break;case"left-bottom":this._element.css({bottom:0,left:0});break;case"right-bottom":this._element.css({bottom:0,right:0});break;case"center":if(this._element.css({top:"50%",left:"50%"}),a.support.transform)this._element.css({"-webkit-transform":"translateX(-50%) translateY(-50%)","-moz-transform":"translateX(-50%) translateY(-50%)","-ms-transform":"translateX(-50%) translateY(-50%)","-o-transform":"translateX(-50%) translateY(-50%)",transform:"translateX(-50%) translateY(-50%)","-webkit-transform-style":"preserve-3d","-moz-transform-style":"preserve-3d","-ms-transform-style":"preserve-3d","-o-transform-style":"preserve-3d","transform-style":"preserve-3d"});else{var e=!1;this._handle().is(":visible")||(this._handle().show(),e=!0);var f=this._options.width||this._element.outerWidth(!0)||this._element.width(),g=this._options.height||this._element.outerHeight(!0)||this._element.height();(!f||1>f)&&(f=this._element.find("img").width()||a(c).width()),(!g||1>g)&&(g=this._element.find("img").height()||a(c).height()),this._options.width=f,this._options.height=g,e&&this._handle().hide(),this._element.css({"margin-left":f/2*-1,"margin-top":g/2*-1})}break;default:if("string"==typeof d)if(a.isFunction(b[d]))b[d](this._element,this);else if(a.isFunction(this[d]))this[d](this._element,this);else{var h={};d=d.split(","),d[0]&&(h.left=d[0].indexOf("%")>-1?a.trim(d[0]):parseFloat(d[0])),d.length>1&&d[1]&&(h.top=d[1].indexOf("%")>-1?a.trim(d[1]):parseFloat(d[1])),this._element.css(h)}else if(d instanceof Array){var h={};d[0]&&(h.left="string"==typeof d[0]&&d[0].indexOf("%")>-1?a.trim(d[0]):parseFloat(d[0])),d.length>1&&d[1]&&(h.top="string"==typeof d[1]&&d[1].indexOf("%")>-1?a.trim(d[1]):parseFloat(d[1])),this._element.css(h)}else a.isFunction(d)&&d(this._element,this)}},open:function(b){function c(){if(this._options.autoClose){this._timerToClose&&clearTimeout(this._timerToClose);var b="number"==typeof this._options.autoClose?this._options.autoClose:1e3;this._timerToClose=setTimeout(a.proxy(this.close,this),b)}a.proxy(d,this)()}function d(){this._element.trigger("open.flythat",[this._element,this]),this._element.trigger("show.flythat",[this._element,this])}if(this._options.hideOnMobile&&this.detectMobile())return!1;if(this._options.position&&this.placeThat(b||this._options.position),this._options.fadeIn){var e="boolean"==typeof this._options.fadeIn?"normal":this._options.fadeIn;this._handle().stop().css({display:"block",visibility:"inherit"}).animate({opacity:1},e,this._options.easing,a.proxy(c,this))}else this._handle().css({display:"block",visibility:"inherit",opacity:1}),a.proxy(c,this)()},close:function(){function b(){this._element.trigger("close.flythat",[this._element,this]),this._element.trigger("hide.flythat",[this._element,this])}if(this._options.hideOnMobile&&this.detectMobile())return!1;if(this._options.fadeOut){var c="boolean"==typeof this._options.fadeOut?"normal":this._options.fadeOut;this._handle().stop().css({display:"block",visibility:"inherit"}).animate({opacity:0},c,this._options.easing,a.proxy(function(){this._handle().css({display:"none",visibility:"hidden"}),a.proxy(b,this)()},this))}else this._handle().css({display:"none",visibility:"hidden",opacity:0}),a.proxy(b,this)()},toggle:function(){return this._handle().is(":visible")?this.close():this.open()},detectMobile:function(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)?!0:!1}},a.fn.flythat=function(b){var c=Array.prototype.slice.call(arguments,1),d="FlyThat",f=this;return this.each("string"==typeof b?function(){var e=a(this).data(d);if(!e)return a.error("Cannot call methods on "+d+' prior to initialization; attempted to call method "'+b+'"');if(!a.isFunction(e[b])||"_"===b.charAt(0))return a.error('No such method "'+b+'" for '+d+" instance");var g=e[b].apply(e,c);return g!==e&&"undefined"!=typeof g?(f=g,!1):void 0}:function(){var c=a(this).data(d);c instanceof e?c.rebuild(b):a(this).data(d,new e(this,b))}),f},a(c).on("click.flythat","[data-flythat]",function(b){b.preventDefault();var c=a(this).data("flythat");if("auto"!=c&&a(c).length){var d=a(c).data("FlyThat");null!=d&&d instanceof e||a(c).flythat(),a(c).flythat("open")}return!1}),a(b).load(function(){a(".flythat").each(function(){var b=a(this).data("FlyThat");null!=b&&b instanceof e||a(this).flythat()})})}(jQuery,window,document);